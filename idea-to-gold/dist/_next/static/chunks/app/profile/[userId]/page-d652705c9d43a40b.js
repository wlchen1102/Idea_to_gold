(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[519],{283:(e,t,s)=>{"use strict";s.d(t,{As:()=>c,AuthProvider:()=>i,XI:()=>o});var a=s(5155),r=s(2115),l=s(2099);let n=(0,r.createContext)(void 0);function i(e){let{children:t}=e,[s,i]=(0,r.useState)({user:null,authUser:null,session:null,loading:!0,token:null,userId:null}),c=async e=>{try{let t=await fetch("/api/users/me/profile",{headers:{Authorization:"Bearer ".concat(e),"Cache-Control":"no-cache"},cache:"no-store"});if(!t.ok)return console.warn("获取用户资料失败:",t.status,t.statusText),null;return(await t.json()).profile}catch(e){return console.warn("获取用户资料异常:",e),null}},o=(0,r.useCallback)(async e=>{var t;let s=null;if((null==e?void 0:e.user)&&(null==e?void 0:e.access_token)){if(!(s=await c(e.access_token))){console.warn("用户资料获取失败，可能token已过期，清理认证状态"),localStorage.removeItem("isLoggedIn"),localStorage.removeItem("userId"),i({user:null,authUser:null,session:null,loading:!1,token:null,userId:null});return}}else localStorage.removeItem("isLoggedIn"),localStorage.removeItem("userId");i({user:s,authUser:(null==e?void 0:e.user)||null,session:e,loading:!1,token:(null==e?void 0:e.access_token)||null,userId:(null==e||null==(t=e.user)?void 0:t.id)||null})},[]),d=async()=>{try{let e=(0,l.$)(),{data:{session:t},error:s}=await e.auth.getSession();if(s){console.warn("获取认证状态失败:",s),await o(null);return}await o(t)}catch(e){console.warn("刷新认证状态异常:",e),await o(null)}},m=async()=>{try{let e=(0,l.$)();await e.auth.signOut(),await o(null),localStorage.removeItem("isLoggedIn"),localStorage.removeItem("userId")}catch(e){console.warn("登出失败:",e)}};(0,r.useEffect)(()=>{let e=!0,t=null,s=null,a=null;return(async()=>{try{let a=(0,l.$)(),{data:{session:r},error:n}=await a.auth.getSession();n&&console.warn("初始化认证状态失败:",n),e&&await o(r);let{data:d}=a.auth.onAuthStateChange(async(t,s)=>{e&&(await o(s),(null==s?void 0:s.user)?(localStorage.setItem("isLoggedIn","true"),localStorage.setItem("userId",s.user.id)):(localStorage.removeItem("isLoggedIn"),localStorage.removeItem("userId")))});return t=d,s=async()=>{if(e)try{let{data:{session:t}}=await a.auth.getSession();if(null==t?void 0:t.access_token){let s=await c(t.access_token);e&&i(e=>({...e,user:s}))}}catch(e){console.warn("更新用户资料失败:",e)}},window.addEventListener("auth:changed",s),()=>{if(e=!1,t)try{t.subscription.unsubscribe()}catch(e){console.warn("取消认证监听器失败:",e)}s&&window.removeEventListener("auth:changed",s)}}catch(t){console.warn("认证初始化异常:",t),e&&i(e=>({...e,loading:!1}))}})().then(e=>{a=e||null}).catch(e=>{console.warn("认证初始化失败:",e)}),()=>{if(e=!1,a)a();else{if(t)try{t.subscription.unsubscribe()}catch(e){console.warn("取消认证监听器失败:",e)}s&&window.removeEventListener("auth:changed",s)}}},[o]);let x={...s,refreshAuth:d,logout:m,signOut:m};return(0,a.jsx)(n.Provider,{value:x,children:t})}function c(){let e=(0,r.useContext)(n);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function o(){let{authUser:e,loading:t}=c();return!t&&!!e}},1871:(e,t,s)=>{Promise.resolve().then(s.bind(s,4554))},2099:(e,t,s)=>{"use strict";s.d(t,{$:()=>i});var a=s(2354);let r="https://bkvbvmgcqfnxokklsxus.supabase.co",l="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJrdmJ2bWdjcWZueG9ra2xzeHVzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ3OTExNjIsImV4cCI6MjA3MDM2NzE2Mn0.uNkB5g0owHKEumiPDzek1K0ZaSDdIJhPT6FwHh0hmJ0",n=r&&l?(0,a.UU)(r,l):null;function i(){if(!r||!l)throw Error("缺少 Supabase 前端环境变量，请配置以下任一组合：\n1) NEXT_PUBLIC_SUPABASE_URL 和 NEXT_PUBLIC_SUPABASE_ANON_KEY\n或\n2) VITE_SUPABASE_URL 和 VITE_SUPABASE_ANON_KEY");if(!n)throw Error("Supabase 客户端未初始化，请刷新页面或检查环境变量");return n}},3540:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var a=s(5155);function r(e){return"string"==typeof e?e:e>=1e6?"".concat((e/1e6).toFixed(1),"m"):e>=1e3?"".concat((e/1e3).toFixed(1),"k"):String(e)}function l(e){let{creativeId:t,authorName:s,authorAvatarUrl:l,publishedAtText:n,title:i,description:c,tags:o=[],upvoteCount:d,commentCount:m,onUpvote:x,onCardClick:u,showDeleteButton:h=!1,onDelete:g,className:p=""}=e;return(0,a.jsxs)("div",{onClick:u,role:u?"button":void 0,tabIndex:u?0:void 0,className:"group bg-white rounded-2xl border border-gray-200 shadow-sm p-6 md:p-7 transition-transform transition-shadow duration-200 hover:shadow-md hover:-translate-y-0.5 ".concat(u?"cursor-pointer":""," ").concat(p),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[l?(0,a.jsx)("img",{src:l,alt:"".concat(s," avatar"),className:"h-10 w-10 rounded-full object-cover"}):(0,a.jsx)("div",{className:"grid h-10 w-10 place-items-center rounded-full bg-[#ecf0f1] text-[#2c3e50] text-sm font-semibold",children:function(e){let t=e.trim();return t?t.split(/\s+/).slice(0,2).map(e=>{var t;return null!=(t=e[0])?t:""}).join("").toUpperCase():"?"}(s)}),(0,a.jsxs)("div",{className:"flex min-w-0 flex-col",children:[(0,a.jsx)("span",{className:"truncate text-[15px] font-medium leading-5 text-[#2c3e50]",children:s}),(0,a.jsx)("span",{className:"text-[13px] leading-5 text-[#95a5a6]",children:n})]})]}),(0,a.jsxs)("div",{className:"mt-4 space-y-3",children:[(0,a.jsx)("h3",{className:"text-xl font-extrabold leading-7 text-[#2c3e50] group-hover:text-[#2ECC71] transition-colors",children:i}),(0,a.jsx)("p",{className:"text-[15px] leading-7 text-gray-600 line-clamp-2",children:c}),o.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:o.map(e=>(0,a.jsx)("span",{className:"rounded-full bg-gray-100 border border-gray-200 px-3 py-1 text-[13px] leading-5 text-gray-700",children:e},e))})]}),(0,a.jsxs)("div",{className:"mt-6 flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,a.jsxs)("div",{className:"inline-flex items-center gap-2 text-[15px] text-[#2c3e50]",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"#3498db",strokeWidth:"2",className:"h-5 w-5",children:(0,a.jsx)("path",{d:"M21 15a4 4 0 0 1-4 4H7l-4 4V5a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4v10z"})}),(0,a.jsx)("span",{children:r(m)})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2 md:flex-row md:gap-3",children:[h&&(0,a.jsxs)("button",{type:"button",onClick:e=>{e.stopPropagation(),null==g||g(t)},className:"inline-flex items-center justify-center gap-2 rounded-xl bg-red-500 px-4 py-2.5 text-[14px] font-semibold text-white hover:bg-red-600 transition-colors w-full md:w-auto","aria-label":"删除创意",children:[(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-4 w-4",children:[(0,a.jsx)("path",{d:"M3 6h18"}),(0,a.jsx)("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),(0,a.jsx)("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"})]}),(0,a.jsx)("span",{children:"删除"})]}),(0,a.jsxs)("button",{type:"button",onClick:e=>{e.stopPropagation(),null==x||x(e)},className:"inline-flex items-center justify-center gap-2 rounded-xl bg-[#2ECC71] px-5 py-2.5 text-[15px] font-semibold text-white hover:bg-[#27AE60] transition-colors w-full md:w-auto","aria-label":"我也要",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-5 w-5",children:(0,a.jsx)("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78L12 21.23l8.84-8.84a5.5 5.5 0 0 0 0-7.78z"})}),(0,a.jsxs)("span",{children:["我也要 (",r(d),")"]})]})]})]})]})}s(2115)},4554:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j,runtime:()=>f});var a=s(5155),r=s(2115),l=s(5695),n=s(6874),i=s.n(n),c=s(6766),o=s(3540);let d=e=>{let{count:t=6}=e;return(0,a.jsx)(a.Fragment,{children:Array.from({length:t}).map((e,t)=>(0,a.jsxs)("div",{className:"animate-pulse rounded-2xl border border-gray-200 bg-white p-6 shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"h-8 w-8 rounded-full bg-gray-200"}),(0,a.jsx)("div",{className:"h-4 w-20 rounded bg-gray-200"})]}),(0,a.jsx)("div",{className:"h-3 w-16 rounded bg-gray-200"})]}),(0,a.jsxs)("div",{className:"mt-4 space-y-2",children:[(0,a.jsx)("div",{className:"h-6 w-3/4 rounded bg-gray-200"}),(0,a.jsx)("div",{className:"h-6 w-1/2 rounded bg-gray-200"})]}),(0,a.jsxs)("div",{className:"mt-3 space-y-2",children:[(0,a.jsx)("div",{className:"h-4 w-full rounded bg-gray-200"}),(0,a.jsx)("div",{className:"h-4 w-5/6 rounded bg-gray-200"}),(0,a.jsx)("div",{className:"h-4 w-2/3 rounded bg-gray-200"})]}),(0,a.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,a.jsx)("div",{className:"h-6 w-12 rounded-full bg-gray-200"}),(0,a.jsx)("div",{className:"h-6 w-16 rounded-full bg-gray-200"}),(0,a.jsx)("div",{className:"h-6 w-14 rounded-full bg-gray-200"})]}),(0,a.jsxs)("div",{className:"mt-6 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:"h-4 w-4 rounded bg-gray-200"}),(0,a.jsx)("div",{className:"h-4 w-8 rounded bg-gray-200"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-1",children:[(0,a.jsx)("div",{className:"h-4 w-4 rounded bg-gray-200"}),(0,a.jsx)("div",{className:"h-4 w-8 rounded bg-gray-200"})]})]}),(0,a.jsx)("div",{className:"h-8 w-20 rounded bg-gray-200"})]})]},t))})};var m=s(8204),x=s(283),u=s(2099);class h{set(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.DEFAULT_EXPIRY,a={data:t,timestamp:Date.now(),expiry:s};this.memoryCache.set(e,a);try{localStorage.setItem("cache_".concat(e),JSON.stringify(a))}catch(e){console.warn("localStorage缓存失败:",e)}}get(e){let t=this.memoryCache.get(e);if(!t)try{let s=localStorage.getItem("cache_".concat(e));s&&(t=JSON.parse(s))&&this.memoryCache.set(e,t)}catch(e){console.warn("localStorage读取失败:",e)}return t?Date.now()-t.timestamp>t.expiry?(this.delete(e),null):t.data:null}delete(e){this.memoryCache.delete(e);try{localStorage.removeItem("cache_".concat(e))}catch(e){console.warn("localStorage删除失败:",e)}}clear(){this.memoryCache.clear();try{Object.keys(localStorage).forEach(e=>{e.startsWith("cache_")&&localStorage.removeItem(e)})}catch(e){console.warn("localStorage清空失败:",e)}}has(e){return null!==this.get(e)}getTimestamp(e){let t=this.memoryCache.get(e);return t?t.timestamp:null}constructor(){this.memoryCache=new Map,this.DEFAULT_EXPIRY=3e5}}let g=new h,p={supportedCreatives:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return"supported_creatives_".concat(e,"_").concat(t)}},v={MEDIUM:3e5},f="edge";function j(){var e;let t=(0,l.useParams)(),s=(0,l.useRouter)(),n=(0,l.useSearchParams)(),h=t.userId,{user:f}=(0,x.As)(),j=(()=>{let e=n.get("tab");return"my-creatives"===e?"createdIdeas":"supported-creatives"===e?"supportedIdeas":"createdIdeas"===e||"supportedIdeas"===e||"developedProjects"===e?e:"createdIdeas"})(),[b,w]=(0,r.useState)(j),[N,y]=(0,r.useState)(null),[k,I]=(0,r.useState)(!0),[S,C]=(0,r.useState)(null),[E,_]=(0,r.useState)([]),[L,A]=(0,r.useState)([]),[P,M]=(0,r.useState)(!1),[T,B]=(0,r.useState)(!1),[U,z]=(0,r.useState)(null),[D,W]=(0,r.useState)(null),[J,O]=(0,r.useState)(1),[R,F]=(0,r.useState)(0),[H,V]=(0,r.useState)(!0),[Z,$]=(0,r.useState)(!1),[X,Y]=(0,r.useState)(!1),[K,q]=(0,r.useState)(null),[G,Q]=(0,r.useState)(""),[ee,et]=(0,r.useState)(!1),es=(0,r.useRef)(!1);(0,r.useEffect)(()=>{let e=async()=>{try{if(I(!0),C(null),f&&f.id===h){y({id:f.id,nickname:f.nickname,avatar_url:f.avatar_url,bio:f.bio}),I(!1),es.current=!0;return}let e=(0,u.$)(),{data:t,error:s}=await e.from("profiles").select("id, nickname, avatar_url, bio").eq("id",h).single();s?(console.error("获取用户资料失败:",s),C("用户不存在或获取资料失败")):(y(t),es.current=!0)}catch(e){console.error("获取用户资料异常:",e),C("获取用户资料时发生错误")}finally{I(!1)}};h&&!es.current&&e()},[h,f]),(0,r.useEffect)(()=>{let e=!1,t=async()=>{if(h&&!e)try{M(!0),z(null);let t=(0,u.$)(),{data:{session:s}}=await t.auth.getSession();if(!(null==s?void 0:s.access_token)){z("登录已过期，请重新登录"),M(!1),localStorage.removeItem("isLoggedIn"),localStorage.removeItem("userId");return}let a=await fetch("/api/users/".concat(h,"/creatives"),{headers:{Authorization:"Bearer ".concat(s.access_token)},cache:"default",signal:AbortSignal.timeout(1e4)});if(!a.ok)throw Error("HTTP ".concat(a.status,": ").concat(a.statusText));let r=await a.json();e||_(r.creatives||[])}catch(t){console.error("获取用户创意失败:",t),e||z(t instanceof Error?t.message:"获取创意列表失败")}finally{e||M(!1)}};return h&&t(),()=>{e=!0}},[h]),(0,r.useEffect)(()=>{let e=!1;return(async()=>{if("supportedIdeas"===b&&h&&!e)try{let t=p.supportedCreatives(h,1),s=g.get(t);if(s){A(s.creatives),F(s.total),V(s.creatives.length<s.total),B(!1);return}B(!0),W(null);let a=(0,u.$)(),{data:{session:r}}=await a.auth.getSession();if(!(null==r?void 0:r.access_token)){W("登录已过期，请重新登录"),B(!1);return}let l=await fetch("/api/users/".concat(h,"/supported-creatives?page=1&limit=10"),{headers:{Authorization:"Bearer ".concat(r.access_token)},cache:"default",signal:AbortSignal.timeout(1e4)});if(!l.ok)throw Error("HTTP ".concat(l.status,": ").concat(l.statusText));let n=await l.json();if(!e){let e=n.creatives||[],s=n.total||0;A(e),F(s),O(1),V(e.length<s),g.set(t,{creatives:e,total:s},v.MEDIUM)}}catch(t){console.error("获取支持的创意失败:",t),e||W(t instanceof Error?t.message:"获取支持的创意列表失败")}finally{e||B(!1)}})(),()=>{e=!0}},[h,b]);let ea=async()=>{if(h&&!Z&&H)try{$(!0);let e=(0,u.$)(),{data:{session:t}}=await e.auth.getSession();if(!(null==t?void 0:t.access_token))return void W("登录已过期，请重新登录");let s=J+1,a=await fetch("/api/users/".concat(h,"/supported-creatives?page=").concat(s,"&limit=10"),{headers:{Authorization:"Bearer ".concat(t.access_token)},cache:"default",signal:AbortSignal.timeout(1e4)});if(!a.ok)throw Error("HTTP ".concat(a.status,": ").concat(a.statusText));let r=(await a.json()).creatives||[];A(e=>[...e,...r]),O(s),V(10===r.length)}catch(e){console.error("加载更多支持的创意失败:",e),W(e instanceof Error?e.message:"加载更多失败")}finally{$(!1)}},er=async()=>{if(K)try{et(!0);let e=(0,u.$)(),{data:{session:t}}=await e.auth.getSession();if(!(null==t?void 0:t.access_token))return void alert("登录已过期，请重新登录");let s=await fetch("/api/creatives/".concat(K),{method:"DELETE",headers:{Authorization:"Bearer ".concat(t.access_token)}});if(!s.ok){let e=await s.json().catch(()=>({}));throw Error(e.error||"HTTP ".concat(s.status,": ").concat(s.statusText))}_(e=>e.filter(e=>e.id!==K)),localStorage.setItem("pendingToast","删除成功"),window.dispatchEvent(new Event("localToast"))}catch(e){console.error("删除创意失败:",e),alert(e instanceof Error?e.message:"删除创意失败")}finally{et(!1),Y(!1),q(null),Q("")}},el=e=>{w(e);let t=new URLSearchParams(n.toString());t.set("tab",e),s.replace("/profile/".concat(h,"?").concat(t.toString()),{scroll:!1})},en=e=>{s.push("/idea/".concat(e,"?fromTab=").concat("createdIdeas"===b?"my-creatives":"supportedIdeas"===b?"supported-creatives":"my-creatives","&fromUserId=").concat(h))},ei=()=>{Y(!1),q(null),Q("")};return k?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"mx-auto max-w-4xl px-4 py-8",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:(0,a.jsxs)("div",{className:"flex items-start gap-6",children:[(0,a.jsx)("div",{className:"w-32 h-32 rounded-full bg-gray-200 animate-pulse"}),(0,a.jsxs)("div",{className:"flex-grow",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded animate-pulse mb-3 w-48"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse mb-2 w-32"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-64"})]})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,a.jsx)("div",{className:"border-b border-gray-200 px-6",children:(0,a.jsx)("div",{className:"flex space-x-8",children:[1,2,3].map(e=>(0,a.jsx)("div",{className:"h-12 w-24 bg-gray-200 rounded animate-pulse my-4"},e))})}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[1,2,3,4,5,6].map(e=>(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"h-6 bg-gray-200 rounded animate-pulse mb-3"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse mb-2"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded animate-pulse w-3/4"})]},e))})})]})]})}):S||!N?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"用户不存在"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:S||"找不到该用户的资料"}),(0,a.jsx)(i(),{href:"/",className:"text-emerald-600 hover:text-emerald-700 font-medium",children:"返回首页"})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,a.jsxs)("div",{className:"mx-auto max-w-4xl px-4 py-8",children:[(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:(0,a.jsxs)("div",{className:"flex items-start gap-6",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:N.avatar_url?(0,a.jsx)(c.default,{src:N.avatar_url,alt:"".concat(N.nickname,"的头像"),width:128,height:128,className:"w-32 h-32 rounded-full object-cover border-4 border-white shadow-lg",unoptimized:!0}):(0,a.jsx)("div",{className:"w-32 h-32 rounded-full bg-gradient-to-br from-emerald-400 to-emerald-600 flex items-center justify-center text-white text-4xl font-bold shadow-lg",children:(null==(e=N.nickname)?void 0:e.charAt(0).toUpperCase())||"U"})}),(0,a.jsxs)("div",{className:"flex-grow",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:N.nickname||"用户"}),(0,a.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-gradient-to-r from-amber-100 to-amber-200 text-amber-800 border border-amber-300",children:"Lv.1"})]}),(0,a.jsx)("p",{className:"text-gray-600 text-base mb-4 leading-relaxed",children:N.bio||"这个用户还没有填写个人简介。"}),(0,a.jsxs)("div",{className:"flex items-center gap-8",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:"1,280"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"声望"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:"15"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"我的创意"})]}),(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:"3"}),(0,a.jsx)("div",{className:"text-sm text-gray-500",children:"我的项目"})]})]})]})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md",children:[(0,a.jsx)("div",{className:"border-b border-gray-200",children:(0,a.jsxs)("nav",{className:"flex gap-8 px-6","aria-label":"选项卡",children:[(0,a.jsx)("button",{onClick:()=>el("createdIdeas"),className:"py-4 px-1 border-b-2 font-medium text-sm transition-colors ".concat("createdIdeas"===b?"border-emerald-500 text-emerald-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),"aria-current":"createdIdeas"===b?"page":void 0,children:"我的创意"}),(0,a.jsx)("button",{onClick:()=>el("supportedIdeas"),className:"py-4 px-1 border-b-2 font-medium text-sm transition-colors ".concat("supportedIdeas"===b?"border-emerald-500 text-emerald-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),"aria-current":"supportedIdeas"===b?"page":void 0,children:"支持的创意"}),(0,a.jsx)("button",{onClick:()=>el("developedProjects"),className:"py-4 px-1 border-b-2 font-medium text-sm transition-colors ".concat("developedProjects"===b?"border-emerald-500 text-emerald-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),"aria-current":"developedProjects"===b?"page":void 0,children:"我的项目"})]})}),(0,a.jsxs)("div",{className:"p-6",children:["createdIdeas"===b&&(0,a.jsxs)("div",{children:[P?(0,a.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-8 h-8 border-4 border-emerald-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"加载创意列表中..."})]})}):U?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"加载失败"}),(0,a.jsx)("p",{className:"text-gray-600",children:U})]}):0===E.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"还没有发布创意"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"快去发布你的第一个创意吧！"}),(0,a.jsx)(i(),{href:"/creatives/new",className:"inline-flex items-center px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors",children:"发布创意"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:E.map(e=>{let t,s=new Date(e.created_at),r=Math.floor((new Date().getTime()-s.getTime())/36e5);t=r<1?"刚刚":r<24?"".concat(r," 小时前"):r<48?"昨天":r<72?"2 天前":r<168?"".concat(Math.floor(r/24)," 天前"):"上周";let l=f&&f.id===e.author_id;return(0,a.jsx)(o.A,{creativeId:e.id,authorName:e.profiles.nickname,publishedAtText:t,title:e.title,description:e.description,tags:e.tags,upvoteCount:e.upvote_count,commentCount:e.comment_count,onCardClick:()=>en(e.id),showDeleteButton:l||!1,onDelete:()=>{var t,s;return t=e.id,s=e.title,void(q(t),Q(s),Y(!0))}},e.id)})}),L.length>0&&H&&(0,a.jsx)("div",{className:"mt-8 text-center",children:(0,a.jsx)("button",{onClick:ea,disabled:Z,className:"inline-flex items-center px-6 py-3 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:Z?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"加载中..."]}):"加载更多"})})]}),"supportedIdeas"===b&&(0,a.jsx)("div",{children:T?(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:(0,a.jsx)(d,{count:6})}):D?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"加载失败"}),(0,a.jsx)("p",{className:"text-gray-600",children:D})]}):0===L.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"还没有支持任何创意"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"快去发现并支持感兴趣的创意吧！"}),(0,a.jsx)(i(),{href:"/",className:"inline-flex items-center px-4 py-2 bg-emerald-600 text-white rounded-lg hover:bg-emerald-700 transition-colors",children:"发现创意"})]}):(0,a.jsx)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:L.map(e=>{let t,s=new Date(e.created_at),r=Math.floor((new Date().getTime()-s.getTime())/36e5);return t=r<1?"刚刚":r<24?"".concat(r," 小时前"):r<48?"昨天":r<72?"2 天前":r<168?"".concat(Math.floor(r/24)," 天前"):"上周",(0,a.jsx)(o.A,{creativeId:e.id,authorName:e.profiles.nickname,publishedAtText:t,title:e.title,description:e.description,tags:e.tags,upvoteCount:e.upvote_count,commentCount:e.comment_count,onCardClick:()=>en(e.id),showDeleteButton:!1},e.id)})})}),"developedProjects"===b&&(0,a.jsx)("div",{children:(0,a.jsxs)("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"flex h-full flex-col justify-between rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-[18px] font-semibold text-[#2c3e50]",children:"会议纪要自动化助手"}),(0,a.jsx)("div",{className:"mt-3 flex items-center gap-3",children:(0,a.jsx)("span",{className:"inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-xs font-medium bg-green-100 text-green-700 border-green-200",children:"开发中"})}),(0,a.jsx)("p",{className:"mt-2 text-sm leading-6 text-gray-600",children:"将会议录音转写并自动抽取行动项，支持与团队协作工具同步。"}),(0,a.jsxs)("div",{className:"mt-4 flex items-start justify-between gap-3",children:[(0,a.jsx)("div",{className:"flex-1 border-l-4 border-gray-200 pl-3",children:(0,a.jsx)(i(),{href:"/idea/1",className:"text-[13px] text-[#3498db] hover:underline",children:"源于创意：AI会议纪要助手"})}),(0,a.jsxs)("div",{className:"flex shrink-0 items-center gap-4 text-[12px] text-gray-500",children:[(0,a.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,a.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:"h-4 w-4",children:[(0,a.jsx)("path",{d:"M2 12s3.5-7 10-7 10 7 10 7-3.5 7-10 7S2 12 2 12Z"}),(0,a.jsx)("circle",{cx:"12",cy:"12",r:"3"})]}),"1280"]}),(0,a.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,a.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:"h-4 w-4",children:(0,a.jsx)("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78Z"})}),"312"]})]})]})]}),(0,a.jsx)("div",{className:"mt-5",children:(0,a.jsx)(i(),{href:"/projects/1",className:"block w-full rounded-lg bg-[#2ECC71] px-4 py-2.5 text-center text-[14px] font-semibold text-white hover:bg-[#27AE60]",children:"管理项目"})})]}),(0,a.jsxs)("div",{className:"flex h-full flex-col justify-between rounded-2xl border border-gray-200 bg-white p-5 shadow-sm",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-[18px] font-semibold text-[#2c3e50]",children:"智能行动项追踪器"}),(0,a.jsx)("div",{className:"mt-3 flex items-center gap-3",children:(0,a.jsx)("span",{className:"inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-xs font-medium bg-gray-100 text-gray-700 border-gray-200",children:"已发布"})}),(0,a.jsx)("p",{className:"mt-2 text-sm leading-6 text-gray-600",children:"基于NLP的行动项归因与提醒工具，帮助团队闭环推进任务。"}),(0,a.jsxs)("div",{className:"mt-4 flex items-start justify-between gap-3",children:[(0,a.jsx)("div",{className:"flex-1 border-l-4 border-gray-200 pl-3",children:(0,a.jsx)(i(),{href:"/idea/2",className:"text-[13px] text-[#3498db] hover:underline",children:"源于创意：行动项提取与提醒"})}),(0,a.jsxs)("div",{className:"flex shrink-0 items-center gap-4 text-[12px] text-gray-500",children:[(0,a.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,a.jsxs)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:"h-4 w-4",children:[(0,a.jsx)("path",{d:"M2 12s3.5-7 10-7 10 7 10 7-3.5 7-10 7S2 12 2 12Z"}),(0,a.jsx)("circle",{cx:"12",cy:"12",r:"3"})]}),"640"]}),(0,a.jsxs)("span",{className:"inline-flex items-center gap-1",children:[(0,a.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.8",className:"h-4 w-4",children:(0,a.jsx)("path",{d:"M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78Z"})}),"120"]})]})]})]}),(0,a.jsx)("div",{className:"mt-5",children:(0,a.jsx)(i(),{href:"/projects/2",className:"block w-full rounded-lg bg-[#2ECC71] px-4 py-2.5 text-center text-[14px] font-semibold text-white hover:bg-[#27AE60]",children:"管理项目"})})]})]})})]})]})]})}),(0,a.jsxs)(m.A,{isOpen:X,onClose:()=>{ee||ei()},children:[(0,a.jsx)("p",{className:"text-[16px] sm:text-[18px] leading-7 text-gray-800",children:"确定删除这条创意吗？"}),(0,a.jsxs)("div",{className:"mt-6 flex items-center justify-end gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:ei,disabled:ee,className:"rounded-md border border-gray-300 px-4 py-2 text-sm font-medium text-[#2c3e50] hover:bg-gray-50 disabled:opacity-50",children:"取消"}),(0,a.jsx)("button",{type:"button",onClick:er,className:"rounded-md bg-red-600 px-5 py-2.5 text-sm font-semibold text-white hover:bg-red-700 disabled:opacity-50",disabled:ee,children:ee?"删除中...":"确认删除"})]})]})]})}},5695:(e,t,s)=>{"use strict";var a=s(8999);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},8204:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var a=s(5155),r=s(2115);function l(e){let{onClick:t,ariaLabel:s="关闭",className:r="",size:l="md"}=e;return(0,a.jsx)("button",{type:"button","aria-label":s,onClick:t,className:"inline-grid place-items-center rounded-full text-gray-400 hover:text-gray-600 hover:bg-gray-100 focus:outline-none focus-visible:ring-2 focus-visible:ring-[#2ECC71] ".concat("sm"===l?"h-7 w-7":"h-8 w-8"," ").concat(r),title:s,children:(0,a.jsx)("svg",{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",className:"h-4 w-4",children:(0,a.jsx)("path",{d:"M18 6 6 18M6 6l12 12"})})})}function n(e){let{isOpen:t,onClose:s,title:n,children:i}=e;return((0,r.useEffect)(()=>{function e(e){"Escape"===e.key&&s()}return t&&document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[t,s]),t)?(0,a.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,a.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:s}),(0,a.jsx)("div",{className:"absolute inset-0 grid place-items-center p-4",children:(0,a.jsxs)("div",{className:"relative w-full max-w-lg rounded-2xl bg-white p-6 shadow-xl",role:"dialog","aria-modal":"true","aria-label":n||"模态弹窗",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-start",children:[n?(0,a.jsx)("h3",{className:"text-lg font-semibold text-[#2c3e50]",children:n}):null,(0,a.jsx)(l,{className:"ml-auto -mr-2 -mt-2",onClick:s})]}),(0,a.jsx)("div",{className:n?"mt-4":"",children:i})]})})]}):null}}},e=>{e.O(0,[874,354,766,441,964,358],()=>e(e.s=1871)),_N_E=e.O()}]);