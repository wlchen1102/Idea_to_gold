(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[762],{788:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var r=s(5155),a=s(2115),n=s(5695),l=s(2379),i=s(2099),c=s(1294),o=s(7428),d=s(1659);function u(){let e=(0,n.useRouter)(),[t,s]=(0,a.useState)(""),[u,h]=(0,a.useState)(""),[m,x]=(0,a.useState)({web:!0,mini:!1,ios:!1,android:!1,win:!1,mac:!1}),[p,f]=(0,a.useState)(!1),b=async()=>{f(!0);try{var s;let r=(0,i.$)(),{data:a,error:n}=await r.auth.getSession(),l=null==a||null==(s=a.session)?void 0:s.access_token;if(n||!l){localStorage.setItem("pendingToast","请先登录后再发布创意"),window.dispatchEvent(new Event("localToast")),f(!1),e.push("/login");return}let c={title:t.trim(),description:u.trim(),terminals:Object.keys(m).filter(e=>m[e]),bounty_amount:0},o=await fetch("/api/creatives",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(l)},body:JSON.stringify(c)});if(o.ok)localStorage.setItem("pendingToast","恭喜！您的创意已成功发布！"),window.dispatchEvent(new Event("localToast")),setTimeout(()=>{e.push("/creatives")},1500);else{let e=await o.json().catch(()=>({})),t=(null==e?void 0:e.error)||(null==e?void 0:e.message)||"未知错误";localStorage.setItem("pendingToast","发布失败：".concat(t)),window.dispatchEvent(new Event("localToast"))}}catch(e){console.error("提交创意时发生错误:",e),localStorage.setItem("pendingToast","发布失败：".concat((null==e?void 0:e.message)||"网络错误，请稍后重试")),window.dispatchEvent(new Event("localToast"))}finally{f(!1)}},g=(0,a.useRef)(null);function v(){let e=g.current;if(!e)return;e.style.height="auto";let t=Math.min(e.scrollHeight,408);e.style.height="".concat(t,"px"),e.style.overflowY=e.scrollHeight>408?"auto":"hidden"}return(0,a.useEffect)(()=>{v()},[u]),(0,a.useEffect)(()=>{v()},[]),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.A,{paths:[{href:"/creatives",label:"创意广场"},{label:"发布新创意"}]}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-6",children:(0,r.jsxs)("section",{className:"mx-auto max-w-2xl",children:[(0,r.jsxs)("header",{className:"mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-extrabold leading-9 text-[#2c3e50]",children:"分享你的绝妙创意"}),(0,r.jsx)("p",{className:"mt-2 text-[#95a5a6]",children:"一个好的创意，是改变世界的开始"})]}),(0,r.jsxs)("form",{className:"space-y-6",children:[(0,r.jsx)("div",{children:(0,r.jsx)(o.A,{id:"title",label:"标题",placeholder:"一句话说清你的点子，如：一个能自动总结会议纪要的AI工具",value:t,onChange:e=>s(e.target.value)})}),(0,r.jsx)("div",{children:(0,r.jsx)(d.A,{id:"desc",label:"点子详情",rows:5,placeholder:"详细描述你的创意、目标用户、场景与可行性...",value:u,onChange:e=>h(e.target.value),autoResize:!0})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"block text-sm font-medium text-[#2c3e50]",children:"期望终端"}),(0,r.jsx)("div",{className:"mt-3 flex flex-wrap gap-3",children:[{id:"web",label:"网页"},{id:"mini",label:"小程序"},{id:"ios",label:"iOS"},{id:"android",label:"安卓"},{id:"win",label:"Windows"},{id:"mac",label:"Mac"}].map(e=>(0,r.jsx)(c.A,{id:e.id,label:e.label,wrapperClassName:"inline-flex cursor-pointer items-center gap-2 rounded-full border border-gray-300 bg-white px-3 py-1.5 text-sm text-gray-700 hover:bg-gray-50",checked:!!m[e.id],onChange:t=>x(s=>({...s,[e.id]:t.target.checked}))},e.id))})]}),(0,r.jsx)("div",{className:"pt-2",children:(0,r.jsx)("button",{type:"button",onClick:b,disabled:p,className:"w-full rounded-lg px-6 py-3 text-[16px] font-semibold text-white ".concat(p?"bg-gray-400 cursor-not-allowed":"bg-[#2ECC71] hover:bg-[#27AE60]"),children:p?"发布中...":"发布创意"})})]})]})})]})}},1294:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(5155);function a(e){let{label:t,description:s,error:a,className:n="",wrapperClassName:l="",...i}=e;return(0,r.jsxs)("label",{className:("inline-flex items-center gap-2 cursor-pointer select-none "+(l||"")).trim(),children:[(0,r.jsx)("input",{type:"checkbox",...i,className:("peer sr-only "+(n||"")).trim()}),(0,r.jsx)("span",{"aria-hidden":"true",className:"relative inline-flex h-4 w-4 items-center justify-center rounded border border-gray-300 bg-white transition-colors duration-150 ease-out peer-focus-visible:outline-none peer-focus-visible:ring-2 peer-focus-visible:ring-[#2ECC71] peer-focus-visible:ring-offset-0 peer-checked:bg-[#2ECC71] peer-checked:border-[#2ECC71] peer-checked:[&>svg]:opacity-100",children:(0,r.jsx)("svg",{viewBox:"0 0 16 16",className:"h-3 w-3 text-white opacity-0 transition-opacity duration-150",fill:"none",stroke:"currentColor",strokeWidth:2.5,strokeLinecap:"round",strokeLinejoin:"round",children:(0,r.jsx)("path",{d:"M4 8l2.5 2.5L12 5"})})}),(t||s||a)&&(0,r.jsxs)("span",{className:"text-sm text-[#2c3e50] leading-5",children:[t&&(0,r.jsx)("span",{children:t}),s&&(0,r.jsx)("div",{className:"text-xs text-gray-500",children:s}),a&&(0,r.jsx)("div",{className:"text-xs text-red-500",children:a})]})]})}s(2115)},1659:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});var r=s(5155),a=s(2115);function n(e){var t;let{label:s,description:n,error:l,className:i="",id:c,autoResize:o=!0,...d}=e,u=(0,a.useRef)(null),h=d.value;(0,a.useEffect)(()=>{if(!o||!u.current)return;let e=u.current,t=()=>{let t=document.activeElement===e,s=t?e.selectionStart:null,r=t?e.selectionEnd:null;if(e.style.height="auto",e.style.height="".concat(e.scrollHeight,"px"),e.style.overflowY="hidden",t&&"number"==typeof s&&"number"==typeof r)try{e.setSelectionRange(s,r)}catch(e){}};t();let s=()=>t();e.addEventListener("input",s);let r=new ResizeObserver(t);return r.observe(e),()=>{e.removeEventListener("input",s),r.disconnect()}},[o,h]);let m=null!=(t=d.rows)?t:2;return(0,r.jsxs)("div",{className:"w-full",children:[s&&(0,r.jsx)("label",{htmlFor:c,className:"block text-sm font-medium text-[#2c3e50]",children:s}),(0,r.jsx)("textarea",{id:c,ref:u,...d,rows:m,className:"".concat(s?"mt-2 ":"","w-full rounded-md border ").concat(l?"border-red-400":"border-gray-300"," bg-white p-3 text-[14px] leading-6 focus:border-[#2ECC71] focus:outline-none resize-none overflow-hidden ")+(i||"")}),n&&(0,r.jsx)("div",{className:"mt-1 text-xs text-gray-500",children:n}),l&&(0,r.jsx)("div",{className:"mt-1 text-xs text-red-500",children:l})]})}},2099:(e,t,s)=>{"use strict";s.d(t,{$:()=>i});var r=s(2354);let a="https://bkvbvmgcqfnxokklsxus.supabase.co",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJrdmJ2bWdjcWZueG9ra2xzeHVzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ3OTExNjIsImV4cCI6MjA3MDM2NzE2Mn0.uNkB5g0owHKEumiPDzek1K0ZaSDdIJhPT6FwHh0hmJ0",l=a&&n?(0,r.UU)(a,n):null;function i(){if(!a||!n)throw Error("缺少 Supabase 前端环境变量，请配置以下任一组合：\n1) NEXT_PUBLIC_SUPABASE_URL 和 NEXT_PUBLIC_SUPABASE_ANON_KEY\n或\n2) VITE_SUPABASE_URL 和 VITE_SUPABASE_ANON_KEY");if(!l)throw Error("Supabase 客户端未初始化，请刷新页面或检查环境变量");return l}},2379:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var r=s(5155),a=s(6874),n=s.n(a);function l(e){let{paths:t}=e;return(0,r.jsx)("nav",{className:"mb-6","aria-label":"面包屑导航",children:(0,r.jsx)("ol",{className:"flex items-center space-x-2 text-sm text-gray-500",children:t.map((e,t)=>(0,r.jsxs)("li",{className:"flex items-center",children:[t>0&&(0,r.jsx)("span",{className:"mx-2 text-gray-400","aria-hidden":"true",children:"/"}),e.href?(0,r.jsx)(n(),{href:e.href,className:"hover:text-[#2ECC71] hover:underline transition-colors",children:e.label}):(0,r.jsx)("span",{className:"text-gray-700 font-medium","aria-current":"page",children:e.label})]},t))})})}},5695:(e,t,s)=>{"use strict";var r=s(8999);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},7428:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var r=s(5155);function a(e){let{label:t,description:s,error:a,className:n="",id:l,...i}=e;return(0,r.jsxs)("div",{className:"w-full",children:[t&&(0,r.jsx)("label",{htmlFor:l,className:"block text-sm font-medium text-[#2c3e50]",children:t}),(0,r.jsx)("input",{id:l,type:"text",...i,className:"mt-2 w-full rounded-md border ".concat(a?"border-red-400":"border-gray-300"," bg-white p-3 text-[14px] focus:border-1 focus:border-[#2ECC71] focus:outline-none ")+(n||"")}),s&&(0,r.jsx)("div",{className:"mt-1 text-xs text-gray-500",children:s}),a&&(0,r.jsx)("div",{className:"mt-1 text-xs text-red-500",children:a})]})}s(2115)},7469:(e,t,s)=>{Promise.resolve().then(s.bind(s,788))}},e=>{e.O(0,[874,354,441,964,358],()=>e(e.s=7469)),_N_E=e.O()}]);